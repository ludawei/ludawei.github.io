<!DOCTYPE html>
<html lang="zh">
<head>

        <title>iOS开发中用到的开源库（整理）</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="/theme/pygment.css" />

        <script src="/theme/js/libs/modernizr-2.6.2.min.js"></script>


              <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-77750244-1', 'auto');
                ga('send', 'pageview');

              </script>


</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h2><a href="/">分享即美德 <strong></strong></a></h2>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>

              <ul class="columns">
                <!-- <li><a href="/">Home</a></li> -->

                <li><a href="/">首页</a></li>
                <li><a href="/archives">归档</a></li>
                <li><a href="/categories">分类</a></li>
                <li><a href="/tags">标签</a></li>
                <li><a href="/aboutme">关于我</a></li>

              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h3 class="entry-title">
                <a href="/ios-third-libs-arrange.html" rel="bookmark"
                   title="Permalink to iOS开发中用到的开源库（整理）">iOS开发中用到的开源库（整理）</a></h3>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2015-01-22T00:00:00+01:00">
                2015年01月22
              </abbr>
              <address class="vcard author">
              <!--               admin
 -->
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>本着不重复造轮子的原则，app开发中或多或少用各种的开源库，用对了开源库，往往能<strong>代码风骚、效率恐怖</strong>~</p>
<p>做iOS也有几年了，整理一下开发中常用到的开源库。</p>
<p _="%" endhighlight="endhighlight">1，<a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a>&nbsp;在iOS开发中使用非常多网络开源库,适用于iOS以及Mac OS X。架构良好，模块清晰，api丰富，绝对是iOS开发中网络库的不二之先。
<div class="message">
<em>AFNetworing</em>是mattt大神的开源库，mattt同时也是<a href="http://nshipster.com/">nshipster</a>的组织者，上面有很多关于iOS的技术文章。
</div>
简单使用示例：
{% highlight objc %}
AFHTTPRequestOperationManager <em>manager = [AFHTTPRequestOperationManager manager];
[manager GET:@"http://example.com/resources.json" parameters:nil success:^(AFHTTPRequestOperation </em>operation, id responseObject) {
    NSLog(@"JSON: %@", responseObject);
} failure:^(AFHTTPRequestOperation <em>operation, NSError </em>error) {
    NSLog(@"Error: %@", error);
}];</p>
<p _="%" endhighlight="endhighlight">2，<a href="https://github.com/rs/SDWebImage">SDWebImage</a>&nbsp;ios开发的图片下载缓存库，实现<strong>懒加载</strong>的得力助手。
<div class="message">
不过新版本的AFNetwording集成了这功能，而且api一样，所以现在基本用不单独用这个库了。
</div>
简单使用示例：
{% highlight objc %}
[cell.imageView setImageWithURL:[NSURL URLWithString:@"http://www.domain.com/path/to/image.jpg"]
               placeholderImage:[UIImage imageNamed:@"placeholder.png"]
                      completed:^(UIImage <em>image, NSError </em>error, SDImageCacheType cacheType) {
                      ... completion code here ...
                      }];</p>
<p>3，<a href="https://github.com/jdg/MBProgressHUD">MBProgressHUD </a>&nbsp;集加载等待、进度条、提示功能于一体的指示器库。
<div class="message">
基于它可以非常简单的生成类型Android的toast的提示效果；
{% highlight objc %}
+ (void)showHUDNoteWithText:(NSString <em>)text
{
    MBProgressHUD </em>hud = [[MBProgressHUD alloc] initWithWindow:[UIApplication sharedApplication].keyWindow];
    hud.mode = MBProgressHUDModeText;
    hud.removeFromSuperViewOnHide = YES;
    [[UIApplication sharedApplication].keyWindow addSubview:hud];
    hud.labelText = text;
    [hud show:YES];
    [hud hide:YES afterDelay:1.5];
}
{% endhighlight %}
</div>
<img alt="gif" src="../images/1月-22-2015-11-34.gif" /></p>
<p _="%" endhighlight="endhighlight">4，<a href="https://developer.apple.com/library/ios/samplecode/Reachability/Introduction/Intro.html">Reachability</a>&nbsp;<code>apple</code>官方给出的在iOS设备上检测网络的库，可以检测网络的连通性，也可以监听网络的变化（由3g到wifi等情况）。
简单使用示例：
{% highlight objc %}
-(int)checkNetWork {
    int isExistenceNetWork;
    Reachability *reachability = [Reachability reachabilityWithHostName:@"www.baidu.com"];
    switch ([reachability currentReachabilityStatus]) {
        case NotReachable://无网络
            isExistenceNetWork = 0;
            break;
        case ReachableVia3G://使用3G或RPRS
            isExistenceNetWork = 1;
            break;
        case ReachableVia2G://使用2G或RPRS
            isExistenceNetWork = 1;
            break;
        case ReachableViaWiFi://使用WiFi
            isExistenceNetWork = 2;
            break;
    }
    return isExistenceNetWork;
}</p>
<p>5，<a href="https://github.com/gotosleep/JASidePanels">JASidePanels</a>&nbsp;左右侧滑的UIViewController容器;
<div class="message">
这样左右侧滑效果在一两年前，相当流行啊！现在好像差不多审美疲劳了~
</div>
<img alt="img" src="https://camo.githubusercontent.com/c7764cc1a74c7a9be35fa09f350adb5622e3eb49/68747470733a2f2f696d672e736b697463682e636f6d2f32303132303332322d6478366b36393537377261333777776771676d73676b737170782e6a7067" /></p>
<p>6，分享组件&nbsp;&nbsp;&nbsp;国内有好多平台，用过的有：
<ul>
<li><a href="http://www.umeng.com/social">友盟</a></li>
<li><a href="http://www.mob.com/">mob</a></li>
<li><a href="http://share.baidu.com/">百度</a></li>
</ul></p>
<p _="%" endhighlight="endhighlight">7，<a href="https://github.com/BradLarson/GPUImage">GPUImage</a>&nbsp;&nbsp; GPUImage是Brad Larson在github托管的一个开源项目，项目实现了图片滤镜、摄像头实时滤镜，该项目的优点不但在于滤镜很多，而且处理效果是基于GPU的，比使用CPU性能更高。
<div class="message">
部分滤镜介绍参考<a href="http://www.cnblogs.com/bunsman/archive/2013/06/06/3121406.html">这里</a>
</div>
<img alt="filterImage" src="../images/屏幕快照2015-01-22下午2.16.00.png" />
简单使用示例：
{% highlight objc %}
GPUImageSepiaFilter <em>stillImageFilter2 = [[GPUImageSepiaFilter alloc] init];
UIImage </em>quickFilteredImage = [stillImageFilter2 imageByFilteringImage:inputImage];</p>
<p>8，<a href="https://github.com/feuvan/opencore-amr-iOS">opencore-amr</a>&nbsp;&nbsp;能将声音转化为amr格式，amr格式十多Ｋ大小就可以长达一分钟的内容，便于网络上传使用。
<div class="message">
编译好的带arm64的库见<a href="https://github.com/ondev/AMR-for-iOS7">这里</a>或者<a href="https://github.com/guange2015/ios-amr">这里</a><br />
因为源码是c语言的，故调用时用到中间函数，示例见<a href="https://github.com/guange2015/ios-amr">这里</a>
</div></p>
<p>9，<a href="https://github.com/jamztang/JTGestureBasedTableViewDemo">JTGestureBasedTableView</a>&nbsp;&nbsp;对UITableViewCell手势的监听操作，个人用到的是它的“长按cell重新排序”的功能；
<img src="https://raw.githubusercontent.com/jamztang/JTGestureBasedTableViewDemo/master/demo4.png" alt="Drawing" style="width: 200px;"/></p>
<p>10，<a href="https://github.com/piemonte/PBJVision">PBJVision</a>&nbsp;&nbsp;PBJVision是iOS摄像头引擎，支持按住屏幕后录制视频和拍照。
<div class="message">
拍摄界面可自定义，拍摄视频尺寸可自定义，功能很强大，谁用谁知道。
</div>
{% highlight objc %}
-(void)viewDidLoad:(Bool)animated
{
    [super viewDidLoad:animated];</p>
<div class="highlight"><pre><span></span><span class="c1">// preview and AV layer</span>
<span class="n">_previewView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">CGRectZero</span><span class="p">];</span>
<span class="n">_previewView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">blackColor</span><span class="p">];</span>
<span class="bp">CGRect</span> <span class="n">previewFrame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">60.0f</span><span class="p">,</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">),</span> <span class="n">CGRectGetWidth</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">));</span>
<span class="n">_previewView</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">previewFrame</span><span class="p">;</span>
<span class="n">_previewLayer</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PBJVision</span> <span class="n">sharedInstance</span><span class="p">]</span> <span class="n">previewLayer</span><span class="p">];</span>
<span class="n">_previewLayer</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">_previewView</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
<span class="n">_previewLayer</span><span class="p">.</span><span class="n">videoGravity</span> <span class="o">=</span> <span class="n">AVLayerVideoGravityResizeAspectFill</span><span class="p">;</span>
<span class="p">[</span><span class="n">_previewView</span><span class="p">.</span><span class="n">layer</span> <span class="nl">addSublayer</span><span class="p">:</span><span class="n">_previewLayer</span><span class="p">];</span>
</pre></div>


<p>}</p>
<ul>
<li>
<p>(void)_setup
{
    _longPressGestureRecognizer.enabled = YES;</p>
<p>PBJVision *vision = [PBJVision sharedInstance];
vision.delegate = self;
vision.cameraMode = PBJCameraModeVideo;
vision.cameraOrientation = PBJCameraOrientationPortrait;
vision.focusMode = PBJFocusModeContinuousAutoFocus;
vision.outputFormat = PBJOutputFormatSquare;</p>
<p _="%" endhighlight="endhighlight">[vision startPreview];
}</p>
</li>
</ul>
<p>11，<a href="https://github.com/enormego/EGOTableViewPullRefresh">EGOTableViewPullRefresh</a>&nbsp;&nbsp;最有名的iOS列表下拉刷新控件。
<div class="message">
源码可任意自定义，修改出各种样式的下拉刷新样式~
</div></p>
<p>12，<a href="https://github.com/CEWendel/SWTableViewCell">SWTableViewCell</a>&nbsp;&nbsp;UITableViewCell右滑删除，效果十分赞~
<img alt="img" src="https://camo.githubusercontent.com/c138fcd3df24ae1d91f8bf6feb51a1cf111606a4/687474703a2f2f692e696d6775722e636f6d2f6e6a4b436a4b382e676966" /></p>
<p>13，<a href="http://developer.baidu.com/wiki/index.php?title=docs/cplat/media/voice">百度语音服务</a>&nbsp;&nbsp;这个服务能帮你把语音变成文本。</p>
<p>简单使用示例：
{% highlight objc %}
- (void)sdkUIRecognition
{
    // 创建识别控件
    self.recognizerViewController = [[BDRecognizerViewController alloc] initWithOrigin:CGPointMake(9, 128) withTheme:[BDTheme lightBlueTheme]];
    self.recognizerViewController.delegate = self;
    //    self.recognizerViewController = tmpRecognizerViewController;</p>
<div class="highlight"><pre><span></span><span class="c1">// 设置识别参数</span>
<span class="n">BDRecognizerViewParamsObject</span> <span class="o">*</span><span class="n">paramsObject</span> <span class="o">=</span> <span class="p">[[</span><span class="n">BDRecognizerViewParamsObject</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>

<span class="c1">// 开发者信息，必须修改API_KEY和SECRET_KEY为在百度开发者平台申请得到的值，否则示例不能工作</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">apiKey</span> <span class="o">=</span> <span class="n">BAIDU_API_KEY</span><span class="p">;</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">secretKey</span> <span class="o">=</span> <span class="n">BAIDU_SECRET_KEY</span><span class="p">;</span>

<span class="c1">// 设置是否需要语义理解，只在搜索模式有效</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">isNeedNLU</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>

<span class="c1">// 设置识别语言</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">BDVoiceRecognitionLanguageChinese</span><span class="p">;</span>

<span class="c1">// 设置识别模式，分为搜索和输入</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">recognitionProperty</span> <span class="o">=</span> <span class="n">EVoiceRecognitionPropertySearch</span><span class="p">;</span>

<span class="c1">// 开启联系人识别</span>
<span class="c1">//paramsObject.enableContacts = YES;</span>

<span class="c1">// 设置显示效果，是否开启连续上屏</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">resultShowMode</span> <span class="o">=</span> <span class="n">BDRecognizerResultShowModeWholeShow</span><span class="p">;</span>

<span class="c1">// 设置提示音开关，是否打开，默认打开</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">recordPlayTones</span> <span class="o">=</span> <span class="n">EBDRecognizerPlayTonesRecordForbidden</span><span class="p">;</span>

<span class="n">paramsObject</span><span class="p">.</span><span class="n">isShowTipAfter3sSilence</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
<span class="n">paramsObject</span><span class="p">.</span><span class="n">isShowHelpButtonWhenSilence</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</pre></div>


<p>//    paramsObject.tipsTitle = @"可以使用如下指令记账";
//    paramsObject.tipsList = [NSArray arrayWithObjects:@"我要记账", @"买苹果花了十块钱", @"买牛奶五块钱", @"第四行滚动后可见", @"第五行是最后一行", nil];</p>
<div class="highlight"><pre><span></span><span class="cp">[</span><span class="bp">self.</span><span class="nx nx-Member">recognizerViewController</span> <span class="nx">startWithParams</span><span class="p">:</span><span class="nx">paramsObject</span><span class="cp">]</span><span class="o">;</span>
</pre></div>


<p _="%" endhighlight="endhighlight">}</p>
<p>14，高德地图sdk，百度地图sdk&nbsp;&nbsp;&nbsp;这两个地图sdk的api基本一样，都包含了<code>apple</code>自己的MapKit的所有api.
<div class="message">
这两地图提供了一些额外的api，如地图覆盖物图层MAGroundOverlay等。<br />
用法见官网吧。
</div></p>
<p>15，<a href="https://github.com/ninjinkun/NJKWebViewProgress">NJKWebViewProgress</a>&nbsp;&nbsp;是一个 UIWebView 的进度条接口库，UIWebView 本身是不提供进度条的。样式与Safari差不多。
<img src="https://camo.githubusercontent.com/082fc708cc461dc53832b7d14d5affdf475dd57b/68747470733a2f2f7261772e6769746875622e636f6d2f6e696e6a696e6b756e2f4e4a4b5765625669657750726f67726573732f6d61737465722f44656d6f4170702f53637265656e73686f742f73637265656e73686f74312e706e67" alt="Drawing" style="width: 200px;"/>
{% highlight objc %}
- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view.</p>
<div class="highlight"><pre><span></span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">];</span>

<span class="n">_progressProxy</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NJKWebViewProgress</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
<span class="n">_progressProxy</span><span class="p">.</span><span class="n">webViewProxyDelegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
<span class="n">_progressProxy</span><span class="p">.</span><span class="n">progressDelegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>

<span class="n">CGFloat</span> <span class="n">progressBarHeight</span> <span class="o">=</span> <span class="mf">2.f</span><span class="p">;</span>
<span class="bp">CGRect</span> <span class="n">navigaitonBarBounds</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="p">.</span><span class="n">navigationBar</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
<span class="bp">CGRect</span> <span class="n">barFrame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">navigaitonBarBounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">progressBarHeight</span><span class="p">,</span> <span class="n">navigaitonBarBounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">progressBarHeight</span><span class="p">);</span>
<span class="n">_progressView</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NJKWebViewProgressView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">barFrame</span><span class="p">];</span>
<span class="n">_progressView</span><span class="p">.</span><span class="n">autoresizingMask</span> <span class="o">=</span> <span class="n">UIViewAutoresizingFlexibleWidth</span> <span class="o">|</span> <span class="n">UIViewAutoresizingFlexibleTopMargin</span><span class="p">;</span>

<span class="n">_webView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIWebView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">height</span><span class="p">)];</span>
<span class="n">_webView</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">_progressProxy</span><span class="p">;</span>
<span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">_webView</span><span class="p">];</span>

<span class="p">[</span><span class="nb">self</span> <span class="n">loadUrl</span><span class="p">];</span>

<span class="c1">// other inits...</span>
</pre></div>


<p>}</p>
<ul>
<li>
<p>(void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];</p>
<p _="%" endhighlight="endhighlight">// self.navigationController.navigationBarHidden = NO;
[self.navigationController.navigationBar addSubview:_progressView];
}</p>
</li>
</ul>
<p>16，<a href="https://github.com/bmorton/ZBarSDK">ZBarSDK</a>&nbsp;&nbsp;条形码和二维码扫描库。
<div class="message">
支持arm64的库到<a href="https://github.com/null09264/ZBarSDK-for-iOS">这里</a>下载<br />
使用方法与调用相机差不多，delegate代码比较多，示例自行google吧。
</div></p>
<p>17，<a href="http://developer.baidu.com/cloud/push">百度推送</a>&nbsp;&nbsp;可管理，更简便的推送功能。
<div class="message">
使用的的实质其实只是用百度推送服务器做了一次中转
<ul>
<li>未使用：我们的服务器-&gt;apns-&gt;iOS设备</li>
<li>使用后：我们的服务器-&gt;百度云推送服务器-&gt;apns-&gt;iOS设备</li>
</ul>
使用的好处是，它提供用户分组，可以单播，分组播等，也提供了统计功能。
</div></p>
<p>18，微信支付，银联支付
<div class="message">
这两个api接口要想成功调用，都必须申请各自平台支付商户号。
其中银联的sdk也得申请完了，人家才会给。</p>
<p>客户端代码比较简单了，所有订单，流水号全在服务上生成完了，参数扔给客户端，
客户端调起各平台的支付界面，就没你事了，成功与否在delegate中找。</p>
<p>支付宝虽然没实际用过，但想来流程也应该差不多~
</div>
部分示例代码：
{% highlight objc %}
-(void)wxPay
{
    TJHttpCmdWXPayData *cmd = [TJHttpCmdWXPayData cmd];
    cmd.payType = @"wx";
    cmd.sign = self.data.sign;
    cmd.tokenId = [TJUserManager sharedInstance].tokenId;
    [cmd setSuccess:^(id object){
        NSLog(@"%@", object);</p>
<div class="highlight"><pre><span></span>    <span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">dict</span> <span class="o">=</span> <span class="p">[</span><span class="n">object</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;payData&quot;</span><span class="p">];</span>

    <span class="nb">self</span><span class="p">.</span><span class="n">payTradeNo</span> <span class="o">=</span> <span class="p">[</span><span class="n">dict</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;tradeNo&quot;</span><span class="p">];</span>

    <span class="c1">// 调起微信支付</span>
    <span class="n">PayReq</span> <span class="o">*</span><span class="n">request</span>   <span class="o">=</span> <span class="p">[[</span><span class="n">PayReq</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
    <span class="n">request</span><span class="p">.</span><span class="n">partnerId</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="s">@&quot;partnerid&quot;</span><span class="p">]];</span>
    <span class="n">request</span><span class="p">.</span><span class="n">prepayId</span>  <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="s">@&quot;prepayid&quot;</span><span class="p">]];</span>
    <span class="n">request</span><span class="p">.</span><span class="n">package</span>   <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="s">@&quot;packages&quot;</span><span class="p">]];</span>      <span class="c1">// 文档为 `Request.package = _package;` , 但如果填写上面生成的 `package` 将不能支付成功</span>
    <span class="n">request</span><span class="p">.</span><span class="n">nonceStr</span>  <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="s">@&quot;noncestr&quot;</span><span class="p">]];</span>
    <span class="n">request</span><span class="p">.</span><span class="n">timeStamp</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="s">@&quot;timestamp&quot;</span><span class="p">]]</span> <span class="n">integerValue</span><span class="p">];</span>

    <span class="n">request</span><span class="p">.</span><span class="n">sign</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="s">@&quot;sign&quot;</span><span class="p">]];</span>

    <span class="c1">// 在支付之前，如果应用没有注册到微信，应该先调用 [WXApi registerApp:appId] 将应用注册到微信</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">WXApi</span> <span class="nl">safeSendReq</span><span class="p">:</span><span class="n">request</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;success~~&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;fail~~&quot;</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}];</span>
<span class="p">[</span><span class="n">cmd</span> <span class="nl">setFail</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">AFHTTPRequestOperation</span> <span class="o">*</span><span class="n">response</span><span class="p">){</span>
    <span class="n">LOG</span><span class="p">(</span><span class="s">@&quot;失败%@&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">);</span>

<span class="p">}];</span>
<span class="p">[</span><span class="n">cmd</span> <span class="n">startRequest</span><span class="p">];</span>
</pre></div>


<p>}</p>
<p>-(void)upPay
{
    TJHttpCmdWXPayData *cmd = [TJHttpCmdWXPayData cmd];
    cmd.payType = @"up";
    cmd.sign = self.data.sign;
    cmd.tokenId = [TJUserManager sharedInstance].tokenId;
    [cmd setSuccess:^(id object){
        NSLog(@"%@", object);</p>
<div class="highlight"><pre><span></span>    <span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">dict</span> <span class="o">=</span> <span class="p">[</span><span class="n">object</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;payData&quot;</span><span class="p">];</span>
    <span class="nb">self</span><span class="p">.</span><span class="n">payTradeNo</span> <span class="o">=</span> <span class="p">[</span><span class="n">dict</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;tradeNo&quot;</span><span class="p">];</span>

    <span class="bp">NSString</span> <span class="o">*</span><span class="n">tn</span> <span class="o">=</span> <span class="p">[</span><span class="n">dict</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;tn&quot;</span><span class="p">];</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">mode</span> <span class="o">=</span> <span class="p">[</span><span class="n">dict</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;model&quot;</span><span class="p">];</span>

    <span class="c1">// 从服务器请求回来tn</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">UPPayPlugin</span> <span class="nl">startPay</span><span class="p">:</span><span class="n">tn</span> <span class="nl">mode</span><span class="p">:</span><span class="n">mode</span> <span class="nl">viewController</span><span class="p">:</span><span class="nb">self</span> <span class="nl">delegate</span><span class="p">:</span><span class="nb">self</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;success~~&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;fail~~&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}];</span>
<span class="p">[</span><span class="n">cmd</span> <span class="nl">setFail</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">AFHTTPRequestOperation</span> <span class="o">*</span><span class="n">response</span><span class="p">){</span>
    <span class="n">LOG</span><span class="p">(</span><span class="s">@&quot;失败%@&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">);</span>

<span class="p">}];</span>
<span class="p">[</span><span class="n">cmd</span> <span class="n">startRequest</span><span class="p">];</span>
</pre></div>


<p _="%" endhighlight="endhighlight">}</p>
<p>还有一些用过的，但不常用，就不介绍了。先到这里，以后有再添加。</p>
            </div><!-- /.entry-content -->
            <div class="comments">
              <!-- <h3><b>Comments</b></h3> -->
            <br />
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                var disqus_identifier = "ios-third-libs-arrange.html";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://davlu.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
              </script>
            </div>


        </div><!-- /.eleven.columns -->

<div class="three columns">

<!-- <h4>方位</h4>

 <ul>
      <li><a href="/">首页</a></li>
      <li><a href="/archives">归档</a></li>
      <li><a href="/categories">分类</a></li>
      <li><a href="/tags">标签</a></li>
      <li><a href="/aboutme">关于我</a></li>
  </ul> -->

<h4>分类</h4>
<ul class="blank">
		<li><a href="/category/gong-ju.html">工具</a>（2）</li>
		<li><a href="/category/ios.html">iOS</a>（12）</li>
		<li><a href="/category/ke-xue-shang-wang.html">科学上网</a>（1）</li>
		<li><a href="/category/markdown.html">markdown</a>（1）</li>
		<li><a href="/category/mysql.html">mysql</a>（1）</li>
		<li><a href="/category/pelican.html">pelican</a>（1）</li>
		<li><a href="/category/php.html">PHP</a>（1）</li>
		<li><a href="/category/qi-ta.html">其它</a>（2）</li>
</ul>


<!-- <h4>标签</h4>
	<ul class="blank">
</ul>
 -->

<!-- <h4>时间</h4>
	<ul class="blank">
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/php-execl-export.md"><a href="/php-excel-export.html">17 二月 2017</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/itc_error_20161017.md"><a href="/itunesConnect导入此构建版本时出错-问题解决.html">17 十月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/MKMapView经纬引起的一个bug.md"><a href="/MKMapView经纬引起的一个bug.html">02 六月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/mac 安装mysql后root密码问题.md"><a href="/mac 安装mysql后root密码问题.html">02 六月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/niceblogs.md"><a href="/someniceblogs.html">02 六月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/一张gif完美诠释pc+app演变史.md"><a href="/一张gif完美诠释pc+app演变史.html">02 六月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/myshadowsocksfromcarina.md"><a href="/在carina上使用Docker搭建免费的ShadowSocks.html">02 六月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/sometools.md"><a href="/sometools.html">25 五月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/fuckingblocks.md"><a href="/fuckingblocks.html">20 五月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/使用pelican在Github pages上搭建博客遇到的坑.md"><a href="/使用pelican在Github pages上搭建博客遇到的坑.html">26 四月 2016</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/tools.md"><a href="/ios-mac-tools.html">29 五月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/custom-xcode-remove-a-line-with-python.md"><a href="/custom-xcode-remove-a-line-with-python.html">10 四月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/ios7-background-modes.md"><a href="/ios7-background-modes.html">27 三月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/ios-bugs-for-march.md"><a href="/iOS-bugs.html">16 三月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/ReactiveCocoa-learning.md"><a href="/ReactiveCocoa-learning.html">05 三月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/UIBarButtonItem-all-types.md"><a href="/UIBarButtonItem-all-types.html">04 二月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/ios-third-libs-arrange.md"><a href="/ios-third-libs-arrange.html">22 一月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/ios-encode.md"><a href="/ios-encode.html">21 一月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/ios-Testing-iOS-simple-pgyer.md"><a href="/ios-Testing-iOS-simple-pgyer.html">19 一月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/Build-my-github.io-blog-from-0.md"><a href="/Build-my-github.io-blog-from-0.html">16 一月 2015</a></li>
	    <li class="article-/Users/ludawei/important/ludawei_blog_github/content/posts/第一个测试.md"><a href="/pelican-install.html">08 九月 2014</a></li>
</ul>
 -->


<nav class="widget">
  <h4>about me</h4>
  <ul class="blank">
    <li><a href="https://github.com/ludawei">github</a></li>
    <li><a href="http://www.cnblogs.com/china-ldw/">cnblog</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

<!-- JiaThis Button BEGIN -->
<!-- <hr/>
<aside>
<nav>
<div class="jiathis_style">
	<span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_tools_1"></a>
	<a class="jiathis_button_tools_2"></a>
	<a class="jiathis_button_tools_3"></a>
	<a class="jiathis_button_tools_4"></a>
	<a href="http://www.jiathis.com/share?uid=2003036" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2003036" charset="utf-8"></script>
</aside>
</nav> -->
<!-- JiaThis Button END -->

<!-- Duoshuo Comment Begin-->
<!-- <aside>
<nav>
<div class="comments">
<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"davlu"};
(function() {
var ds = document.createElement('script');
ds.type = 'text/javascript';ds.async = true;
ds.src = 'http://static.duoshuo.com/embed.js';
ds.charset = 'UTF-8';
(document.getElementsByTagName('head')[0]
 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<noscript>Please enable JavaScript to view the comments.</noscript>
</nav>
</aside> -->
<!-- Duoshuo Comment End -->


       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">


        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Creared by dav@2016 and Proudly powered by <a href="http://getpelican.com/">Pelican</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


<!-- <script type="text/javascript">
    var disqus_shortname = 'davlu';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
 -->
  <script src="/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="/theme/js/libs/gumby.min.js"></script>
  <script src="/theme/js/plugins.js"></script>
</body>
</html>